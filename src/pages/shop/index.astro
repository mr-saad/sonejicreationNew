---
import Layout from "../../layout/Layout.astro"
import { Image } from "astro:assets"
import type { ProductType } from "../index.astro"

const baseURL = import.meta.env.VERCEL_URL
  ? `https://${import.meta.env.VERCEL_URL}`
  : "http://localhost:4321"

const products = await (
  await fetch(`${baseURL}/api/products`, {
    method: "GET",
    headers: {
      "Content-Type": "application/json"
    }
  })
).json()
---

<Layout title="Shop">
  <section class="container shop">
    <h2 class="heading">Shop</h2>
    <div class="grid">
      {
        products.map((elems: ProductType) => {
          return (
            <a
              href={`/shop/${elems.slug}`}
              class="card radius flex flex-column"
            >
              {elems.image && (
                <Image
                  quality={"mid"}
                  width={400}
                  height={400}
                  src={elems.image.asset.url}
                  alt={elems.slug}
                />
              )}
              <h3 class="details flex flex-1 align-center">{elems.title}</h3>
            </a>
          )
        })
      }
    </div>
  </section>
</Layout>

<style>
  .card img {
    width: 100%;
    height: auto;
    object-fit: cover;
  }
  .card .details {
    padding: 1rem;
  }
</style>

<!-- const products = [
  {
    img: "https://m.media-amazon.com/images/I/715lRionMRL._SL1500_.jpg",
    title: "Lorem, ipsum dolor.",
    desc: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Nulla, consequatur.",
  },
  {
    img: "https://m.media-amazon.com/images/I/715lRionMRL._SL1500_.jpg",
    title: "Lorem, ipsum dolor.",
    desc: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Nulla, consequatur.",
  },
  {
    img: "https://m.media-amazon.com/images/I/715lRionMRL._SL1500_.jpg",
    title: "Lorem, ipsum dolor.",
    desc: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Nulla, consequatur.",
  },
  {
    img: "https://m.media-amazon.com/images/I/715lRionMRL._SL1500_.jpg",
    title: "Lorem, ipsum dolor.",
    desc: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Nulla, consequatur.",
  },
  {
    img: "https://m.media-amazon.com/images/I/715lRionMRL._SL1500_.jpg",
    title: "Lorem, ipsum dolor.",
    desc: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Nulla, consequatur.",
  },
  {
    img: "https://m.media-amazon.com/images/I/715lRionMRL._SL1500_.jpg",
    title: "Lorem, ipsum dolor.",
    desc: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Nulla, consequatur.",
  },
  {
    img: "https://m.media-amazon.com/images/I/715lRionMRL._SL1500_.jpg",
    title: "Lorem, ipsum dolor.",
    desc: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Nulla, consequatur.",
  },
  {
    img: "https://m.media-amazon.com/images/I/715lRionMRL._SL1500_.jpg",
    title: "Lorem, ipsum dolor.",
    desc: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Nulla, consequatur.",
  },
  {
    img: "https://m.media-amazon.com/images/I/715lRionMRL._SL1500_.jpg",
    title: "Lorem, ipsum dolor.",
    desc: "Lorem ipsum, dolor sit amet consectetur adipisicing elit. Nulla, consequatur.",
  },
] -->
